build-ios:
    runs-on: macos-latest
    env:
      APP_NAME: "StudentBehavior"
      
    steps:
      # 1. ØªØ­Ù…ÙŠÙ„ ÙƒÙˆØ¯ Ø§Ù„Ù…Ø´Ø±ÙˆØ¹ Ù…Ù† GitHub
      - name: ğŸ“¥ ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ù…Ø´Ø±ÙˆØ¹
        uses: actions/checkout@v4
      
      # 2. Ø¥Ø¹Ø¯Ø§Ø¯ Ø¨ÙŠØ¦Ø© Python
      - name: ğŸ Ø¥Ø¹Ø¯Ø§Ø¯ Python
        uses: actions/setup-python@v5
        with:
          python-version: '3.11'
      
      # 3. ØªØ«Ø¨ÙŠØª Ù…ÙƒØªØ¨Ø§Øª Python Ø§Ù„Ù…Ø·Ù„ÙˆØ¨Ø©
      - name: ğŸ“¦ ØªØ«Ø¨ÙŠØª Ø§Ù„Ù…ÙƒØªØ¨Ø§Øª
        run: |
          pip install 'flet[cli]' --upgrade
          pip install -r requirements.txt
      
      # 4. Ø¥Ø¹Ø¯Ø§Ø¯ Ø¨ÙŠØ¦Ø© Flutter
      - name: ğŸš€ Ø¥Ø¹Ø¯Ø§Ø¯ Flutter
        uses: subosito/flutter-action@v2
        with:
          flutter-version: '3.22.0'
          channel: 'stable'
      
      # 5. Ø§Ù„Ø®Ø·ÙˆØ© Ø§Ù„Ø£Ø³Ø§Ø³ÙŠØ©: Ø¥Ù†Ø´Ø§Ø¡ Ù‡ÙŠÙƒÙ„ Ù…Ø´Ø±ÙˆØ¹ Flet Ø¨Ø§Ø³ØªØ®Ø¯Ø§Ù… Ø§Ù„Ù‚Ø§Ù„Ø¨ 'minimal'
      - name: ğŸ”§ Ø¥Ù†Ø´Ø§Ø¡ Ù…Ø´Ø±ÙˆØ¹ Flet
        run: |
          flet create "$APP_NAME" --template minimal
          cp main.py "$APP_NAME"/
          cp requirements.txt "$APP_NAME"/
          cd "$APP_NAME"
      
      # 6. Ø¨Ù†Ø§Ø¡ Ù…Ù„Ù IPA Ù„ØªØ·Ø¨ÙŠÙ‚ iOS
      - name: ğŸ”¨ Ø¨Ù†Ø§Ø¡ ØªØ·Ø¨ÙŠÙ‚ iOS
        run: |
          flet build ipa --project "$APP_NAME" --org "com.education" --verbose
      
      # 7. ØªØ¬Ù…ÙŠØ¹ Ù…Ù„Ù IPA Ø¥Ø°Ø§ Ù„Ù… ÙŠØªÙ… Ø§Ù„Ø¹Ø«ÙˆØ± Ø¹Ù„ÙŠÙ‡ ØªÙ„Ù‚Ø§Ø¦ÙŠÙ‹Ø§ (Ø®Ø·ÙˆØ© Ø§Ø­ØªÙŠØ§Ø·ÙŠØ©)
      - name: ğŸ“¦ ØªØ¬Ù…ÙŠØ¹ IPA ÙŠØ¯ÙˆÙŠÙ‹Ø§
        run: |
          APP_BUNDLE=$(find . -name "*.app" -type d | head -n1)
          if [ -n "$APP_BUNDLE" ]; then
            mkdir -p Payload
            cp -r "$APP_BUNDLE" Payload/
            zip -qr "$APP_NAME.ipa" Payload
          fi
      
      # 8. Ø±ÙØ¹ Ù…Ù„Ù IPA Ø§Ù„Ù†Ø§ØªØ¬ ÙƒÙ…Ø±ÙÙ‚ (Artifact) ÙÙŠ GitHub
      - name: â¬†ï¸ Ø±ÙØ¹ Ø§Ù„ØªØ·Ø¨ÙŠÙ‚ Ø§Ù„Ù†Ù‡Ø§Ø¦ÙŠ
        uses: actions/upload-artifact@v4
        with:
          name: ØªØ·Ø¨ÙŠÙ‚-iOS
          path: "*.ipa"
